 
c/Users/dentabramasta/Amazin-Project/APIGateaway/AmazinGateaway/User-Service/Services/UserService.cs
	namespace 	
User_Service
 
. 
Services 
;  
public 
class 
UserService 
{		 
private

 
readonly

 
IMongoCollection

 %
<

% &
	UserModel

& /
>

/ 0
_userCollection

1 @
;

@ A
public 

UserService 
( 
IOptions 
<  
DatabaseSettings  0
>0 1
databaseSettings2 B
)B C
{ 
var 
mongoClient 
= 
new 
MongoClient )
() *
databaseSettings* :
.: ;
Value; @
.@ A
ConnectionStringA Q
)Q R
;R S
var 
mongoDb 
= 
mongoClient !
.! "
GetDatabase" -
(- .
databaseSettings. >
.> ?
Value? D
.D E
DatabaseNameE Q
)Q R
;R S
_userCollection 
= 
mongoDb !
.! "
GetCollection" /
</ 0
	UserModel0 9
>9 :
(: ;
databaseSettings; K
.K L
ValueL Q
.Q R
CollectionNameR `
)` a
;a b
} 
public 

async 
Task 
< 
List 
< 
	UserModel $
>$ %
>% &
GetAsync' /
(/ 0
)0 1
=>2 4
await5 :
_userCollection; J
.J K
FindK O
(O P
_P Q
=>R T
trueU Y
)Y Z
.Z [
ToListAsync[ f
(f g
)g h
;h i
public 

async 
Task 
< 
	UserModel 
>  
GetAsync! )
() *
string* 0
id1 3
)3 4
=>5 7
await 
_userCollection 
. 
Find "
(" #
x# $
=>% '
x( )
.) *
Id* ,
==- /
id0 2
)2 3
.3 4
FirstOrDefaultAsync4 G
(G H
)H I
;I J
public 

async 
Task 
CreateAsync !
(! "
	UserModel" +
	userModel, 5
)5 6
=>7 9
await: ?
_userCollection@ O
.O P
InsertOneAsyncP ^
(^ _
	userModel_ h
)h i
;i j
public 

async 
Task 
UpdateAsync !
(! "
	UserModel" +
	userModel, 5
)5 6
=>7 9
await 
_userCollection 
. 
ReplaceOneAsync -
(- .
x. /
=>0 2
x3 4
.4 5
Id5 7
==8 :
	userModel; D
.D E
IdE G
,G H
	userModelI R
)R S
;S T
public 

async 
Task 
RemoveAsync !
(! "
string" (
id) +
)+ ,
=>- /
await0 5
_userCollection6 E
.E F
DeleteOneAsyncF T
(T U
xU V
=>W Y
xZ [
.[ \
Id\ ^
==_ a
idb d
)d e
;e f
} ¯
V/Users/dentabramasta/Amazin-Project/APIGateaway/AmazinGateaway/User-Service/Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
	Configure 
< 
DatabaseSettings +
>+ ,
(, -
builder- 4
.4 5
Configuration5 B
.B C

GetSectionC M
(M N
$strN ]
)] ^
)^ _
;_ `
builder		 
.		 
Services		 
.		 
AddSingleton		 
<		 
UserService		 )
>		) *
(		* +
)		+ ,
;		, -
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
! 
app 
. 	
Environment	 
. 
IsDevelopment "
(" #
)# $
)$ %
{ 
app 
. 
UseExceptionHandler 
( 
$str )
)) *
;* +
app 
. 
UseHsts 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 
UseStaticFiles 
( 
) 
; 
app 
. 
UseAuthorization 
( 
) 
; 
app 
. 
MapGet 

(
 
$str 
, 
( 
) 
=> 
$str 7
)7 8
;8 9
app 
. 
MapControllers 
( 
) 
; 
app 
. 
MapControllerRoute 
( 
name   
:   	
$str  
 
,   
pattern!! 
:!! 
$str!! 5
)!!5 6
;!!6 7
app## 
.## 
Run## 
(## 
)## 	
;##	 
†

_/Users/dentabramasta/Amazin-Project/APIGateaway/AmazinGateaway/User-Service/Models/UserModel.cs
	namespace 	
User_Service
 
. 
Models 
; 
public 
class 
	UserModel 
{ 
[ 
BsonId 
] 
[ 
BsonRepresentation 
( 
BsonType  
.  !
ObjectId! )
)) *
]* +
public 

string 
? 
Id 
{ 
get 
; 
set 
;  
}! "
[

 
BsonElement

 
(

 
$str

 
)

 
]

 
public

  
string

! '
Name

( ,
{

- .
get

/ 2
;

2 3
set

4 7
;

7 8
}

9 :
=

; <
null

= A
!

A B
;

B C
[ 
BsonElement 
( 
$str 
) 
] 
public $
string% +
Username, 4
{5 6
get7 :
;: ;
set< ?
;? @
}A B
=C D
nullE I
!I J
;J K
} Ç)
i/Users/dentabramasta/Amazin-Project/APIGateaway/AmazinGateaway/User-Service/Controllers/UserController.cs
	namespace 	
User_Service
 
. 
Controllers "
;" #
[ 
ApiController 
] 
[ 
Route 
( 
$str 
) 
] 
public		 
class		 
UserController		 
:		 
ControllerBase		 ,
{

 
private 
readonly 
UserService  
_userService! -
;- .
public 

UserController 
( 
UserService %
userService& 1
)1 2
=>3 5
_userService6 B
=C D
userServiceE P
;P Q
[ 
HttpGet 
( 
$str 
) 
]  
public 

async 
Task 
< 
IActionResult #
># $
Get% (
(( )
string) /
id0 2
)2 3
{ 
var 
existingUser 
= 
await  
_userService! -
.- .
GetAsync. 6
(6 7
id7 9
)9 :
;: ;
if 

( 
existingUser 
is 
null  
)  !
return 
NotFound 
( 
) 
; 
return 
Ok 
( 
existingUser 
) 
;  
} 
[ 
HttpGet 
] 
public 

async 
Task 
< 
IActionResult #
># $

GetAllUser% /
(/ 0
)0 1
{ 
var 
users 
= 
await 
_userService &
.& '
GetAsync' /
(/ 0
)0 1
;1 2
if 

( 
users 
. 
Any 
( 
) 
) 
return 
Ok 
( 
users 
) 
; 
return 
NotFound 
( 
) 
; 
}   
[## 
HttpPost## 
]## 
public$$ 

async$$ 
Task$$ 
<$$ 
IActionResult$$ #
>$$# $
PostUser$$% -
($$- .
	UserModel$$. 7
	userModel$$8 A
)$$A B
{%% 
await&& 
_userService&& 
.&& 
CreateAsync&& &
(&&& '
	userModel&&' 0
)&&0 1
;&&1 2
return'' 
CreatedAtAction'' 
('' 
nameof'' %
(''% &
Get''& )
)'') *
,''* +
new'', /
{''0 1
id''2 4
=''5 6
	userModel''7 @
.''@ A
Id''A C
}''D E
,''E F
	userModel''G P
)''P Q
;''Q R
}(( 
[** 
HttpPut** 
(** 
$str** 
)** 
]**  
public++ 

async++ 
Task++ 
<++ 
IActionResult++ #
>++# $

UpdateUser++% /
(++/ 0
String++0 6
id++7 9
,++9 :
	UserModel++; D
	userModel++E N
)++N O
{,, 
var-- 
existingUser-- 
=-- 
await--  
_userService--! -
.--- .
GetAsync--. 6
(--6 7
id--7 9
)--9 :
;--: ;
if.. 

(.. 
existingUser.. 
is.. 
null..  
)..  !
return// 

BadRequest// 
(// 
)// 
;//  
	userModel11 
.11 
Id11 
=11 
existingUser11 #
.11# $
Id11$ &
;11& '
await33 
_userService33 
.33 
UpdateAsync33 &
(33& '
	userModel33' 0
)330 1
;331 2
return44 
Ok44 
(44 
)44 
;44 
}55 
[77 

HttpDelete77 
(77 
$str77 !
)77! "
]77" #
public88 

async88 
Task88 
<88 
IActionResult88 #
>88# $

DeleteUser88% /
(88/ 0
String880 6
id887 9
)889 :
{99 
var:: 
existingUser:: 
=:: 
await::  
_userService::! -
.::- .
GetAsync::. 6
(::6 7
id::7 9
)::9 :
;::: ;
if;; 

(;; 
existingUser;; 
is;; 
null;;  
);;  !
return<< 

BadRequest<< 
(<< 
)<< 
;<<  
await>> 
_userService>> 
.>> 
RemoveAsync>> &
(>>& '
id>>' )
)>>) *
;>>* +
return@@ 
	NoContent@@ 
(@@ 
)@@ 
;@@ 
}AA 
}CC ×
m/Users/dentabramasta/Amazin-Project/APIGateaway/AmazinGateaway/User-Service/Configuration/DatabaseSettings.cs
	namespace 	
User_Service
 
. 
Configuration $
;$ %
public 
class 
DatabaseSettings 
{ 
public 

string 
ConnectionString "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
null3 7
!7 8
;8 9
public 

string 
DatabaseName 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
null/ 3
!3 4
;4 5
public 

string 
CollectionName  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
null1 5
!5 6
;6 7
}		 